
import { Shield, AlertTriangle, CheckCircle } from "lucide-react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Progress } from "@/components/ui/progress";
import { Badge } from "@/components/ui/badge";

const VulnerabilityPanel = () => {
  const vulnerabilities = [
    {
      id: "CVE-2024-001",
      title: "Remote Code Execution",
      severity: "Critical",
      score: 9.8,
      status: "Open",
      affected: "Web Application"
    },
    {
      id: "CVE-2024-002",
      title: "SQL Injection",
      severity: "High",
      score: 8.2,
      status: "Patched",
      affected: "Database Layer"
    },
    {
      id: "CVE-2024-003",
      title: "Cross-Site Scripting",
      severity: "Medium",
      score: 6.1,
      status: "Open",
      affected: "Frontend"
    },
    {
      id: "CVE-2024-004",
      title: "Information Disclosure",
      severity: "Low",
      score: 3.7,
      status: "Acknowledged",
      affected: "API Endpoints"
    }
  ];

  const getSeverityColor = (severity: string) => {
    switch (severity) {
      case "Critical": return "text-red-400";
      case "High": return "text-orange-400";
      case "Medium": return "text-yellow-400";
      case "Low": return "text-blue-400";
      default: return "text-gray-400";
    }
  };

  const getStatusIcon = (status: string) => {
    switch (status) {
      case "Patched": return <CheckCircle className="h-4 w-4 text-green-500" />;
      case "Open": return <AlertTriangle className="h-4 w-4 text-red-500" />;
      default: return <Shield className="h-4 w-4 text-yellow-500" />;
    }
  };

  return (
    <Card className="bg-gray-800 border-gray-700">
      <CardHeader>
        <CardTitle className="flex items-center space-x-2 text-white">
          <Shield className="h-5 w-5" />
          <span>Vulnerabilities</span>
        </CardTitle>
      </CardHeader>
      <CardContent>
        <div className="space-y-4">
          {vulnerabilities.map((vuln) => (
            <div
              key={vuln.id}
              className="p-4 bg-gray-750 border border-gray-600 rounded-lg hover:bg-gray-700 transition-colors"
            >
              <div className="flex items-start justify-between mb-2">
                <div>
                  <div className="font-medium text-white">{vuln.title}</div>
                  <div className="text-sm text-gray-400">{vuln.id}</div>
                </div>
                <div className="flex items-center space-x-2">
                  {getStatusIcon(vuln.status)}
                  <Badge variant="outline" className="text-xs">
                    {vuln.status}
                  </Badge>
                </div>
              </div>
              <div className="flex items-center justify-between mb-2">
                <span className={`text-sm font-medium ${getSeverityColor(vuln.severity)}`}>
                  {vuln.severity}
                </span>
                <span className="text-sm text-gray-400">Score: {vuln.score}</span>
              </div>
              <Progress value={vuln.score * 10} className="h-2 mb-2" />
              <div className="text-xs text-gray-500">Affects: {vuln.affected}</div>
            </div>
          ))}
        </div>
      </CardContent>
    </Card>
  );
};

export default VulnerabilityPanel;
